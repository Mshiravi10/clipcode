<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clear Auth Cookies - clipcode</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 12px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            margin: 0 0 20px 0;
            color: #333;
            font-size: 24px;
        }

        p {
            color: #666;
            line-height: 1.6;
            margin: 10px 0;
        }

        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: none;
        }

        .success.show {
            display: block;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            font-weight: 600;
        }

        button:hover {
            background: #5568d3;
        }

        .code {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 6px;
            font-family: monospace;
            margin: 10px 0;
            overflow-x: auto;
        }

        .step {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            border-radius: 4px;
        }

        .step h3 {
            margin: 0 0 10px 0;
            color: #667eea;
            font-size: 16px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ðŸ”§ Fix Authentication Issues</h1>
        <p>This page will clear all NextAuth cookies and help fix the redirect loop.</p>

        <div class="step">
            <h3>Step 1: Clear Cookies</h3>
            <button onclick="clearCookies()">Clear All NextAuth Cookies</button>
        </div>

        <div class="success" id="success">
            âœ… <strong>Cookies Cleared!</strong><br>
            All authentication cookies have been removed.
        </div>

        <div class="step">
            <h3>Step 2: Manual Browser Clear (Recommended)</h3>
            <p>In addition to the button above, please also manually clear cookies:</p>
            <ul>
                <li><strong>Chrome/Edge:</strong> Press <code>F12</code> â†’ Application â†’ Cookies â†’ Delete all for this
                    site</li>
                <li><strong>Firefox:</strong> Press <code>F12</code> â†’ Storage â†’ Cookies â†’ Delete all</li>
            </ul>
        </div>

        <div class="step">
            <h3>Step 3: Restart Server</h3>
            <p>In your terminal:</p>
            <div class="code">cd apps/web<br>npm run dev</div>
        </div>

        <div class="step">
            <h3>Step 4: Test</h3>
            <p>After restarting:</p>
            <ol>
                <li>Go to: <div class="code">http://192.168.161.27:3000</div>
                </li>
                <li>You should see the sign-in page</li>
                <li>Click "Sign in with GitHub"</li>
                <li>Complete OAuth and you'll be logged in!</li>
            </ol>
        </div>
    </div>

    <script>
        function clearCookies() {
            // Clear all possible NextAuth cookie names
            const cookieNames = [
                'next-auth.session-token',
                '__Secure-next-auth.session-token',
                'next-auth.callback-url',
                '__Secure-next-auth.callback-url',
                'next-auth.csrf-token',
                '__Host-next-auth.csrf-token',
                '__Secure-next-auth.csrf-token',
            ];

            const domains = [
                '192.168.161.27',
                'localhost',
            ];

            const paths = ['/', '/auth', '/api/auth'];

            // Clear all combinations
            cookieNames.forEach(name => {
                domains.forEach(domain => {
                    paths.forEach(path => {
                        // Basic clear
                        document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path};`;
                        document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path}; domain=${domain};`;

                        // With port
                        document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path}; domain=${domain}:3000;`;
                        document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path}; domain=${domain}:3001;`;
                    });
                });
            });

            // Show success message
            document.getElementById('success').classList.add('show');

            console.log('All NextAuth cookies cleared!');
            console.log('Current cookies:', document.cookie);
        }
    </script>
</body>

</html>